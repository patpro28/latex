\section{Truy vấn hai cây}\label{trai-dong-2024-o}

\subtitle{Time limit: \textbf{1 giây} \hfill Memory limit: \textbf{256}Mb}

\subsection{Đề bài}\label{trai-dong-2024-o-de-bai}

Cho hai cây $A$ và $B$. Cây $A$ có $n$ đỉnh, đỉnh $u$ có cha
là $p_u$, đỉnh $1$ là gốc. Cây $B$ có $m$ đỉnh, đỉnh $v$ có
cha là $f_v$, đỉnh $1$ là gốc. Có $k$ cặp liên kết giữa đỉnh $u$
của cây $A$ và đỉnh $v$ của cây $B$ với trọng số là $w$. Có
$q$ truy vấn, mỗi truy vấn gồm hai đỉnh $x$ của cây $A$ và đỉnh
$y$ của cây $B$, hãy tính tổng trọng số của các liên kết của các cặp
$(u, v)$ mà $u$ nằm trên đường đi từ $x$ đến gốc của cây $A$ và
$v$ nằm trên đường đi từ $y$ đến gốc của cây $B$.

\subsection{Dữ liệu vào}\label{trai-dong-2024-o-du-lieu-vao}

Dòng đầu chứa số $n$ $(1\le n\le 2\cdot 10^5)$

Dòng thứ hai chứa $n$ số $p_2, p_3, ..., p_n$

Dòng thứ ba chứa số $m$ $(1\le m\le 2\cdot 10^5)$

Dòng thứ tư chứ $m$ số $f_2, f_4, ..., f_m$

Dòng thứ năm chứa số $k$ $(1\le k\le 2\cdot 10^5)$

$k$ dòng tiếp theo, mỗi dòng chứa ba số $u, v, w$
$(1\le u\le n; 1\le v\le m; 1\le w\le 10^9)$

Dòng tiếp theo chứa số $q$ $(1\le q\le 10^5)$

$q$ dòng tiếp theo, mỗi dòng chứa hai số $x, y$
$(1\le x\le n; 1\le y\le m)$

\subsection{Dữ liệu ra}\label{trai-dong-2024-o-du-lieu-ra}

Mỗi truy vấn ghi kết quả ra một dòng.

\subsection{Tính điểm}\label{trai-dong-2024-o-tinh-diem}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  $(15p)$: $n, m, k, q\le 1000$
\item
  $(25p)$: $q\le 2000$; chiều cao của cây không quá $5000$
\item
  $(35p)$: cây có dạng đường thẳng
\item
  $(25p)$: không có ràng buộc gì thêm.
\end{enumerate}

\subsubsection{Sample Input 1}\label{trai-dong-2024-o-sample-input-1}

\begin{tcolorbox}
\begin{verbatim}
5
1 4 2 4
4
4 4 1
3
1 4 5
2 2 3
4 1 7
4
1 1
2 4
3 2
5 3
\end{verbatim}
\end{tcolorbox}

\subsubsection{Sample Output 1}\label{trai-dong-2024-o-sample-output-1}

\begin{tcolorbox}
\begin{verbatim}
0
5
15
12
\end{verbatim}
\end{tcolorbox}
