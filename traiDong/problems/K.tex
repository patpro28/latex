\section{Xây dựng dãy số}\label{trai-dong-2024-k}

\subtitle{Time limit: \textbf{2 giây} \hfill Memory limit: \textbf{512}Mb}

\subsection{Đề bài}\label{trai-dong-2024-k-de-bai}

Hãy xây dựng dãy $a$ có $n$ phần tử đánh số từ $1$ đến $n$ từ
trái qua phải thoả mãn có thể chia dãy $a$ thành các đoạn mà độ dài
mỗi đoạn nằm trong khoảng $[p, q]$ và nếu đánh số các đoạn từ $1$ từ
trái qua phải thì đoạn thứ $i$ chỉ chứa các số các giá trị $i$.
Ngoài ra có $m$ ràng buộc $a_i = v$.

Hãy tìm dãy $a$ chia được nhiều đoạn nhất và có thứ tự từ điển nhỏ
nhất thoả mãn các điều kiện đã cho.

\subsection{Dữ liệu vào}\label{trai-dong-2024-k-du-lieu-vao}

Dòng đầu ghi $4$ số tự nhiên $n, p, q$ và $m$
($2\le p < q\le n\le 2\cdot 10^6, 1\le m\le N$).

$m$ dòng sau, mỗi dòng chứa hai số $i, v$ $(1\le i\le n)$ mô tả
các ràng buộc $a_i = v$.

\subsection{Dữ liệu ra}\label{trai-dong-2024-k-du-lieu-ra}

Dòng đầu in ra số đoạn lớn nhất chia được,

Dòng thứ hai in ra $n$ số $a_1, a_2,..., a_n$, dữ liệu đảm bảo luôn
tồn tại kết quả.

\subsection{Tính điểm}\label{trai-dong-2024-k-tinh-diem}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  $20\%$: $n\le 20$
\item
  $20\%$: $n\le 100, q\le 50$
\item
  $20\%$: $n\le 3\cdot 10^4, q\le 300$
\item
  $20\%$: $n\le 10^5$
\item
  $20\%$: không có ràng buộc gì thêm.
\end{enumerate}

\subsubsection{Sample Input 1}\label{trai-dong-2024-k-sample-input-1}

\begin{tcolorbox}
\begin{verbatim}
5 2 3 1
3 2
\end{verbatim}
\end{tcolorbox}

\subsubsection{Sample Output 1}\label{trai-dong-2024-k-sample-output-1}

\begin{tcolorbox}
\begin{verbatim}
2
1 1 2 2 2
\end{verbatim}
\end{tcolorbox}

\subsubsection{Sample Input 2}\label{trai-dong-2024-k-sample-input-2}

\begin{tcolorbox}
\begin{verbatim}
6 2 5 2
2 1
6 3
\end{verbatim}
\end{tcolorbox}

\subsubsection{Sample Output 2}\label{trai-dong-2024-k-sample-output-2}

\begin{tcolorbox}
\begin{verbatim}
3
1 1 2 2 3 3
\end{verbatim}
\end{tcolorbox}
